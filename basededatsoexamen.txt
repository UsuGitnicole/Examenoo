




SOLUCCION DEL EXAMEN"""""""""""""""""""""""""""""""""""

1º select avg(salary) from employee;
2º select max(salary) -min(salary) from employee;
3º select avg (salary+nvl(comicion,0))from employee where dep_id>=20 and dep_id <= 29;
4º select depart_id, avg(salary), count (depart-id)  from employee where comision is null group by department_id;
5º select max(cominsion), department_id from employee where job_id=669 and job_id=670 group by dep_id;
6º select department_id, avg(salary) from employee group by department_id having count (department_id>=2);
7º select max(sum(total)) from sales order group by costumers_id;
8º select min(salary) from employee where min(salary) <=1200 group by department_id;
9º select 'el cliente'||customer_id||'ha gastado'||sum(total),min(total0,max(total) from sales_order froup by costumer_id;






2º select count (salary), count (distinct(salary)) from employee
3º select max (salary+comision) from employee
4º select id_depar, count(salary) from employee group by id_depart, salary having count(salary) > a
5º select depart_i, count(depar_id) from employee where salary >2000 group by depart_id
6º select depart_id, avg(salary) from employee having >2000 group by depart_id
7º select min(count(employee_id)) from employee group by depart_id
8º select id_employee, avg(salary+nv)-(comision,0)+50 from employee group by id_department
9º select product_id,min(list_price), max(list_price), "hay un" ||((1-(MIN()list_price)/max(list_price)))*100||"% de variacion" from price group by product_id;



Ejercicio de base de datos:::::::::::::::::::::::::::::::::::::::::::::::::::::::::

muestra los nombre de los empleados con un salario entre 2000 y 2900 cuyo oficio sea manager




SELECT APELLIDO FROM EMPLEADOS WHERE OFICIO IN (SELECT OFICIO FROM EMPLEADOS WHERE SALARIO BETWEEN 2000 AND 2900);

GARRIDO
MARTINEZ



SOLUCCIONES:::::::::::::::::::::::::::::::::.....
1º SELECT LAST_NAME, FIRST_NAME FROM EMPLOYEE WHERE SALARY BETWEEN 2000 AND 2900 AND JOB_ID=(SELECT JOB_ID FROM JOB WHERE FUNCTION='MANAGER');

2º SELECT DISTINCT NAME FROM DEPARTMENT WHERE NOT EXISTS (SELECT *FROM EMPLOYEE  WHERE EMPLOYEE.DEPARTMENT_ID=DEPARTMENT.DEPARTMENT_ID);
2º SELECT DISTINCT NAME FROM DEPARTMENT WHERE DEPARTMENT_ID <> ALL (SELECT DEPARTMENT_ID FROM EMPLOYEE);

3º SELECT DISTINCT NAME FROM DEPARTMENT WHERE EXISTE(SELECT *FROM EMPLOYEE WHERE EMPLOYEE.DEPARTMENT_ID=DEPARTMENT.DEPARTMENT_ID);
3º SELECT DEPARTMENT_ID,NAME,LOCATION_ID FROM DEPARTMENT WHERE DEPARTMENT_ID=ANY(SELECT DEPARTMENT_ID FROM EMPLOYEE);



employee.department_id en casod e que quieras sacar empleados de otra tabla department_id.
<>ALL es igual a NOT IN.
=any es igual a alguno.


SELECT * FROM EMPLEADOS WHERE SALARIO>(SELECT MAX SALARIO) FROM EMPLEADOS WHERE DEP_NO=30;
SELECT COUNT(OFICIO) FROM EMPLEADOS WHERE OFICIO='VENDEDOR' AND DEP_NO=(SELECT DEP_NO FROM DEPARTAMENTOS WHERE D_NOMBRE='VENTAS');

Eº SELECT SUM(salario) FROM EMPLEADOS WHERE DEP_NO=(SELECT DEP_NO FROM DEPARTAMENTOS WHERE DNOMBRE ='VENTAS')GROUP BY DEP_ID;
Fº SELECT APELLIDO FROM EMPLEADOS WHERE DEP_NO IN (SELECT DEP_NO FROM DEPARTAMENTOS WHERE LOCALIDAD NOT IN ('MADRID', 'BARCELONA') ORDER BY LOCALIDAD DESC);
Gº SELECT DNOMBRE FROM DEPARTAMENTOS WHERE DEP_NO=(SELECT DEP_NO FROM EMPLEADOS WHERE TO_CHAR(FECHA_ALTA,'YYYY)<1982);
Hº SELECT DNOMBRE FROM DEPARTAMENTOS WHERE EXISTS (SELECT EMP_NO FROM EMPLEADOS WHERE COMISION IS NULL); | SELECT DNOMBRE FROM DEPARTAMENTOS WHERE EXISTS (SELECT EME_NO FROM EMPLEADOS where dep.dep_no=emp.dep_no and where comision is null;
Iº SELECT DNOMBRE FROM DEPARTAMENTOS WHERE DEP_NO NOT IN (SELECT DISTINCT DEP_NO FROM EMPLEADOS);
Jº SELECT DNOMBRE FROM DEPARTAMENTOS WHERE DEP_NO =ANY (SELECT DEP_NO FROM EMPLEADOS);
   SELECT DNOMBRE FROM DEPARTAMENT WHERE DEP_NO IN (SELECT DEP_NO FROM EMPLEADOS GROUP BY DEP_NO HAVING COUNT (EMP_NO)>1);
Kº SELECT EMP_NO, APELIDO, DEP_NO, FECHA_ALTA FROM EMPLEADOS WHERE DEP_NO =(SELECT DEP_NO FROM EMPLEADOS WHERE APELLIDO='GARRIDO' AND FECHA_ALTA='28/09/81');
   SELECT EMP_NO, APELLIDO FROM EMPLEADOS WHERE DEP_NO=(SELECT DEP_NO FROM EMPLEADOS WHERE APELLIDO='GARRIDO') AND  FECHA_ALTA=(SELECT FECHA_ALTA FROM EMPLEADOS WHERE APELIDO='GARRIDO') /AND APELLIDO <>'GARRIDO';
Mº SELECT EMP_NO, APELLIDO FROM EMPLEADOS WHERE DEP_NO =(SELECT DEP_NO FROM EMPLEADOS WHERE APELLIDO='JIMENEZ')AND SALARIO =(SELECT MAX(SALARIO) FROM EMPLEADOS WHERE DEP_NO=EMP.DEP_NO);
Nº SELECT DEP_NO, EMP_NO, APELLIDO FROM EMPLEADOS WHERE SALARIO IN (SELECT MAX(SALARIO) FROM EMPLEADOS GROUP BY DEP_NO) ORDER BY DEP_NO;

SELECT EMP_NO , APELLIDO, DIRECTOR, DEP_NO FROM EMPLEADOS WHERE DEP_NO=(SELECT DEP_NO FROM EMPLEADOS WHERE APELLIDO='ALONSO' AND DIRECTOR=(SELECT DIRECTOR FROM EMPLEADOS WHERE APELLIDO='ALONSO')AND APELLIDO <> 'ALONSO');
WHERE (DEP_NO,DIRECTOR)=SELECT DEP_NO, DIRECTOR FROM EMPLEADOS WHERE APELLIDO='ALONSO'

SELECT DEP_NO, AVG(SALARIO) FROM EMPLEADOS GROUP BY DEP_NO HAVING AVG(SALARIO)>=(SELECT AVG(SALARIO)FROM EMPLEADOS);

SELECT DEP_NO, SUM(SALARIO) FROM EMPLEADOS GROUP BY DEP_NO HAVING SUM(SALARIO)=(SELECT MIN(TOTAL_SALARIO) FROM (SELECT SUM(SALARIO)AS TOTAL_SALARIO FROM EMPLEADOS GROUP BY DEP_NO));
SELECT DEP_NO, SALARIO_TOTAL FROM (SELECT DEP_NO, sum(salario) AS SALARIO_TOTAL FROM EMPLEADOS GROUP BY DEP_NO)

SELECT DEP_NO, DNOMBRE FROM DEPARTAMENTO WHERE DEP_NO (SELECT DEP_NO FROM EMPLEADOS WHERE OFICIO='VENDEDOR' GROUP BY DEP_NO HAVING COUNT(OFICIO)>=ALL (SELECT COUNT (OFICIO) FROM EMPLEADO WHERE OFICIO='VENDEDOR' GROUP BY DEP_NO));

SELECT DEP_NO, SALARIO_TOTAL FROM DEP_NO, SUM(SALARIO) AS SALARIO_TOTAL FROM EMPLEADOS GROUP BY DEP_NO ORDER BY SALARIO_TOTAL) WHERE ROWNUMBER<2;

SELECT * FROM DEPARTAMENTOS WHERE DEP_NO IN (SELECT DEP_NO FROM)

SELECT * FROM DEPARTAMENTOS WHERE DEP_NO IN (SELECT DEP_NO FROM EMPLEADOS WHERE APELLIDO='GIL' AND FECHA_ALTA<=ALL(SELECT FECHA_ALTA FROM EMPLEADOS WHERE OFICIO =(SELECT OFICIO FROM EMPLEADOS WHERE APELLIDO='GIL')));

SELECT * FROM EMPLEADOS WHERE (OFICIO, FECHA_ALTA) IN (SELECT OFICIO, MIN(FECHA_ALTA)FROM EMPLEADOS GROUP BY OFICIO);


UNIADA 7 COMPOSICIONES::::::::::::::::::::::::::::::::::::::::::::::::::::::::::.

*Se utilizan en caso de 

*Que es el producto cartesiano

SELECT D.DEPARTMENT_ID, D.NAME, COUNT(EMPLOYEE_ID) FROM EMPLOYEE E, DEPARTMENT D WHERE E.DEPARTMENT_ID(+)=D.DEPARTMENT_ID GROUP BY D.DEPARTMENT_ID , D.NAME;

SELECT D.DEPARTMENT_ID, D.NAME, COUNT(EMPLOYEE_ID) FROM DEPARTMENT D LEFT JOIN EMPLOYEE E ON D.DEPARTMENT_ID = E.DEPARTMENT_ID GROUP BY D.DEPARTMENT_ID, D.NAME;



1º COLUMNA DE AGRUPACIO Y 



A) selectd.dnombre, e.APELLIDO, D.LOCALIDAD FROM DEPARTAMENTOS D, EMPLEADOS E  WHERE E.DEP_NO=D.DEP_NO;
B) SELECT E1 APELLIDO, E2 APELLIDO FROM EMPLEADOS E1, EMPLEADOS E2 WHERE E1.DIRECTOR=E2.DIRECTOR;
C) SELECT E2.APELLIDO, E1.APELLIDO VENDEDOR, E1.APELLIDO DIRECTOR FROM EMPLEADO E1, EMPLEADO E2 WHERE E1.EMPLEADO=E2.EMPLEADO aAND E2.OFICIO='VENDEDOR';
D) SELECT D.DNOMBRE, D.LOCALIDAD, E.APELLIDO FROM DEPARTAMENTOS D LEFT JOIN EMPLEADOSE ON D.DEP_NO=E.DEP_NO;
E) SELECT D.NOMBRE, D.LOCALIDAD, COUNT(EMP_NO) FROM DEPARTAMENTOS DLEFT JOIN EMPLEADOS ON D.DEP_NO, EMPLEADO_DEP_NO GROUP BY D.NOMBRE, D.LOCALIDAD;
F) SELECT PR.DESCRIPCION, PR.PEDIDO, E1.NOMBRE, PR.UNIDADES FROM PRODUCTOS PR LEFT JOIN PEDIDOS P ON PR.PED_NO LEFT JOIN CLIENTES ON P.CLIENTE_NO=C.CLIENTE_NO;
G) SELECT PE.PEDIDO _NO, PE_UNIDADES, PE.FECHA_PEDIDO, C.NOMBRE, C.LOCALIDAD, C.HABER, P.DESCRIPION FROM PEDIDOS PE JOIN CLIENTES C ON PE.CLIENTES_NO=C.CLIENTE_NO WHERE PE.FECHA_PEDIDO<'1/10/2014' AND PE.UNIDADES>=3;
H) SELECT P.DESCRIPCION, COUNT(*), SUM(P.PRECIO_ACTUAL*P.D.UNIDADES) FROM PRODUCTOS P LEFT JOIN PEDIDOS PD ON P.PRODUCTO_NO GROUP BY P.PRODUCTO_NO, P.DESCRIPCION;
I) SELECT C.NOMBRE, C.LOCALIDAD COUNT (P.PEDIDO_NO) CANTIDAD_PEDIDOS, NVL (SUM(P.UNIDADES), 0) FROM CLIENTES C LEFT JOIN PEDIDOS P ON C.CLIENTE_NO=P.CLIENTE_NO GROUP BY C.NOMBRE, C.LOCALIDAD, P.PEDIDO, P.UNIDADES,  
J) SELECT E.* FROM EMPLEADOS E JOIN EMPLEADOS D ON E.DIRECTOR=D.EMP_NO JOIN EMPLEADOS PD ON D.DIERCTOR=E.EMP_NO AND PD.OFICIO='PRESIDENTE'; 
K) 
M) 


J) SELECT E.* FROM EMPLEADOS E JOIN EMPLEADOS D ON E.DIRECTOR=D.EMP_NO JOIN EMPLEADOS PD ON D.DIERCTOR=E.EMP_NO AND PD.OFICIO='PRESIDENTE'; 


SELECT E.* FROM EMPLEADOS E JOIN EMPLEADOS D ON E.DIRECTOR=D.DIRECTOR JOIN EMPLEADOS PD ON PD.DEP_NO=E.DEP_NO AND PD.OFICIO='PRESIDENTE' ; 





:::::::::::::::::::::::::::::::::Formatos de seleccion basicos::::::::::::::::::::::::::::::::::::


SELECT: para realizar consulta

*: se selecciona todas las columnas

+deben ir dentro de corchetes_________________________________
	ALL: obtiees todos los valores incluyendo los repetidos
	DISTINCT: obtienes los valores no repetidos







delete o update modifican 






delete o update paramodificar













ABS(-3)=3
POWER (2,4)= 16 
FLOOR(15,3)=15
CEIL(14,58)=15
ROUND(3,2)=3
SING()= +=1, -=-1,0=0
SQRT(9)=3
MOD(33,2)=RESULTADO DE UNA DIVISION=1
RANDOM()= NUMERO ALEATORIO
TRUNC(-57.35)=NOS DEVUELVE LA PARTE ENTERA DE ESE NUM= -57
TRUNC (-57.325456787, 2)= NOS PERMITE SELECCIONAR CANTIDAD DE DECIMALES =-57.32




position('hola' in 'hola mundo')= 1
lenght('hola')=4
upper
lower
substr('hola mundo---', 5, 8)= numdo-- 
lpad('hola mundo', 15, '-')= --hola mundo
rtrim y ltrim para elimiar caracteres especificos ya sean a la derecha o a la izquierda.
lpad('hola mundo', 5,8)














